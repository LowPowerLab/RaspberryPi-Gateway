//https://github.com/remy/bind.js
var Bind=function e(n){"use strict";function t(e){return(e+"").replace(/[<>]/g,function(e){return{">":"&gt;","<":"&lt;"}[e]})}function r(e,n){for(var t=e.length,r=0;t>r;r++)n(e[r],r,e)}function i(e,n){var t="pop push reverse shift sort splice unshift".split(" ");r(t,function(t){this[t]=function(){this.__dirty=!0;var r=c({},u[t].apply(this,arguments));return delete this.__dirty,e&&n.ready&&e(this),r}.bind(this)}.bind(this));var i=this.length;return Object.defineProperty(this,"length",{configurable:!1,enumerable:!0,set:function(e){if(this.__dirty)return void(i=e);var n=1*e;return i!==n&&(n>i?this.push.apply(this,new Array(n-i)):this.splice(n),i=n),e},get:function(){return i}}),this}function a(e,n,s,u){return u||(u=[]),s.ready&&n.__callback?e:(r(Object.getOwnPropertyNames(n),function(y){if("__callback"!==y){var v,b=n[y],_=[].slice.call(u),g=function(e){return t(e)},k=h;_.push(y);var m=s.mapping[_.join(".")];if(m&&"[object Object]"===m.toString()&&(m.callback&&(v=m.callback),m.transform&&(g=p(m.transform.bind({safe:t}))),m.parse&&(k=p(m.parse)),m=m.dom),"function"==typeof m)v=m;else if("string"==typeof m){var A=o(m||"☺");0===A.length&&console.warn('No elements found against "'+m+'" selector');var O=["SELECT","INPUT","PROGRESS","TEXTAREA"];(null===b||void 0===b)&&(b=k(-1!==O.indexOf(A[0].nodeName)?A[0].value:A[0].innerHTML));var j=v;v=function(n){A=o(m||"☺"),A&&r(A,function(e){if(!e.__dirty)if(-1!==O.indexOf(e.nodeName)){var t=g(n);if("checkbox"===e.type){if(n instanceof Array){var i=n.filter(function(n){return n===e.value?(e.checked=e.value===n,!0):void 0});0===i.length&&(e.checked=!1)}}else if("radio"===e.type)e.checked=e.value===t;else if("number"==typeof e.value)try{e.value=1*t}catch(a){console.error(a.message)}else e.value=t}else{n instanceof Array||(n=[n]);var c="";r(n,function(e){c+=g(e)}),e.innerHTML=c}}),j&&j.apply(e,arguments)},r(A,function(n){if("INPUT"===n.nodeName||"SELECT"===n.nodeName||"TEXTAREA"===n.nodeName){var t=function(){this.__dirty=!0;var t;if("checkbox"===n.type){var i=(n.form||document).querySelectorAll('input[name="'+n.name+'"][type="'+n.type+'"]');if(e[y]instanceof Array){var a=[];r(i,function(e){e.checked&&a.push(k(e.value))}),t=a}else t=this.checked?k(this.value):null}else"radio"===n.type&&(t=this.checked?k(this.value):null),t=k("number"==typeof e[y]?1*this.value:this.value);void 0===t&&(t=this.value),e[y]=t,this.__dirty=!1},i={checkbox:"change",radio:"change"}[n.type];n.addEventListener(i||"input",t)}})}v&&_.reduce(function(e,n,t,r){return e[n]||(e[n]={}),t===r.length-1&&(e[n].__callback=v),e[n]},s.callbacks);var E=function(e){var n=[],t=[],r=s.instance,i=!1,a=!1;if(l&&console.log("> finding callback for %s",y,_),_.reduce(function(o,l,s){if(o&&o[l]&&l){if(r=r[l],null===r||void 0===r)return o[l]||{};if("function"==typeof o[l].__callback){var u=s===_.length-1?e:r;r.__dirty&&(i=!0),s===_.length-1&&o[l].__callback&&(a={path:_.join("."),callback:o[l].__callback,instance:u}),i||(t.push(c(u instanceof Array?[]:{},u)),n.push(o[l].__callback))}return o[l]||{}}},s.callbacks),i||(t.reverse(),n.reverse().forEach(function(e,n){e.call(s.instance,t[n])})),i&&a){var r=a.instance;a.callback.call(s.instance,c(r instanceof Array?[]:{},r))}},N={configurable:!0,enumerable:!0,set:function(n){var t=b!==n?b:void 0;b=!s.ready||typeof n!==d||null===n||f(n)||n.__callback?f(n)?a(new i(E,s),n,s,_):n:a(e[y]?c({},e[y]):{},n,s,_),l&&console.log("set: key(%s): %s -> %s",y,JSON.stringify(t),JSON.stringify(n)),s.ready?E(b):s.deferred.push(E.bind(e,b,t))},get:function(){return b}};try{Object.defineProperty(e,y,N)}catch(P){}typeof b!==d||null===b||f(b)?f(b)?e[y]=a(new i(E,s),b,s,_):e instanceof i||(e[y]=b):e[y]=a(e[y]||{},b,s,_)}}),e instanceof i&&e.push.apply(e,n),e)}function c(n,t){return t instanceof Object?(r(Object.getOwnPropertyNames(t),function(r){var i=t[r];e.prototype[r]||"__callback"===r||(typeof i===d&&null!==i&&i instanceof Array?n[r]=[].map.call(i,function(e){return e instanceof Object?c(n[r]||{},e):e}):typeof i!==d||null===i||f(i)?n[r]=i:n[r]=c(n[r]||{},i))}),n):t}function e(t,i){if(!this||this===n)return new e(t,i);var c={mapping:i||{},callbacks:{},deferred:[],ready:!1,instance:this};return a(this,t,c),c.ready=!0,c.deferred.length&&r(c.deferred,function(e){e()}),this}if(!Function.bind||!Object.defineProperty)throw new Error("Prerequisite APIs not available.");var o,l=!1;try{o=document.querySelectorAll.bind(document)}catch(s){}var u=[],f=Array.isArray,d="object",h=function(e){return e},p=function(e){return function(){try{return e.apply(this,arguments)}catch(n){console.error(n.stack?n.stack:n)}}};return i.prototype=[],e.prototype.__export=function(){return c({},this)},e}(this);"undefined"!=typeof exports&&(module.exports=Bind);